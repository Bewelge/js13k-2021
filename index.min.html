<!DOCTYPE html>
 
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="interface.css">
</head>

<body>
   
        <canvas id="b"></canvas>
        <canvas id="c"></canvas>
        <canvas id="h"></canvas>
        <div id="zoomBar"><div id="zoomHandle"></div></div>
        <input checked id="debug" type="checkbox"></input><label>Debug</label> 
    <style>body,html{width:100%;height:100%;position:absolute;top:0;left:0;margin:0;background-color:#000;min-width:1000px;max-width:100%;max-height:100%;font-family:"Gill Sans MT"}#b,#c,#h{position:absolute;top:0;left:0;margin:0}#zoomBar{position:absolute;right:50px;bottom:50px;height:calc(100% - 400px);background-color:#000;border:green 1px solid;width:10px;box-sizing:border-box;pointer-events:all;cursor:pointer}#zoomHandle{box-sizing:border-box;position:absolute;width:20px;border-radius:5px;height:20px;top:10px;left:-5px;background-color:#000;border:1px solid green;cursor:pointer;pointer-events:all}#debug{position:absolute;z-index:5;top:10;left:10;color:#fff}label{color:#fff;position:absolute;left:25px}.dialog{background-color:#000;width:100%;top:0;left:0;height:0%;overflow:hidden;z-index:6;position:absolute;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;justify-content:space-around;align-content:center;transition:height .3s ease-out}.dialog button:hover{color:#000;background-color:#eee}.dialog button{transition:all .3s ease-out;padding:1em;font-size:20px;text-align:center;font-weight:800;font-family:"Gill Sans MT";border:none;color:#fafafa;background-color:#0f0f0f}.cont{display:flex;flex-direction:row;justify-content:space-evenly}.dialog .subTitle,.dialog .title{text-align:center;width:100%;font-size:40px;color:rgba(250,250,250,1);margin-top:20px}.dialog .subTitle{font-size:20px}.col,.colWide{display:flex;flex-direction:column;justify-content:center}.colWide{flex-grow:.3;user-select:none}.comp,.compWide{display:flex;flex-direction:row;color:#fafafa;margin:5px;padding:10px;transition:all .3s ease-out;box-sizing:border-box}.compWide{flex:5;justify-content:space-between;align-items:center;min-width:300px}.comp{background-color:rgba(70,70,70,1)}.comp.clickable:hover{background-color:rgba(50,50,50,1)}.comp.selected{box-shadow:inset 0 0 0 5px #fff}.statRow{height:20px;float:none}.statRow div{font-size:14px;float:left;margin-right:1em}.statRow{white-space:nowrap}.plus{color:green}.minus{color:red}.statValueChange{color:#fff}.statName{white-space:nowrap;text-align:center;flex-grow:1}.statRow .statName2{float:right}.statValue2{text-align:right}</style>
        <script>!function(){var t=!0;const e=Math.PI/2,h=2*Math.PI;var a,n,o,i,l,s=window.innerWidth,r=window.innerHeight,M={x:0,y:0};let u=Math.floor(99999*Math.random());console.log("Ship seed: "+u);var c,f,d=25,w=3500,m={x:0,y:0},p=0,b={},g=!1,x={},y=new Set;const S=6e3,P=.01;var k=!1,D=window.performance.now(),W=0,v={},H={},O=0,C={},j={};let R={};var T,A,Y,z,I,L,N=[],V={},E={},F=0;function B(){u=Math.floor(99999*Math.random());let t=Wt(u),h={x:Math.floor(1e4*t()),y:Math.floor(1e4*t())};for(console.log("Home Planet: x: "+h.x+", y:"+h.y);!nt(h)||!ot(h.x,h.y).t.length;)h={x:Math.floor(1e4*t()),y:Math.floor(1e4*t())},console.log("Home Planet: x: "+h.x+", y:"+h.y);M=lt(ot(h.x,h.y).t[0],p),H={seed:u,race:gt(t),h:!1,o:!1,x:M.x+25,y:M.y+25,level:1,i:-e,l:null,M:{x:0,y:0},u:0,m:{x:0,y:0},p:.1,speed:.006,g:.04,S:.95,P:60,k:1,D:0,W:2e3,v:.02,H:30,O:vt(u,.01)}}class G{constructor(t){this.seed=t.seed,this.O=vt(this.seed,H.level/500),this.race=gt(Wt(t.seed)),this.H=t.H,this.g=t.g,this.speed=t.speed,this.W=t.W,this.D=0,this.k=t.k/this.O.j.C,this.P=t.P,this.R=t.R,this.v=t.v||.02,this.T=t.T,this.size=t.size;let e=this.A();this.x=e.x,this.y=e.y,this.m={x:0,y:0},this.Y=0,this.i=Math.random()*h}I(){xe(this.m,-this.i,.05),Q(this.seed,this.O.j,this,this.size,this.i,this.v,this.k,this.W)}update(){let t=Ut(this,H);this.D>0&&(this.D-=1*(this.O.j.L?.5:1)),t<this.R?(t<this.H&&(!this.O.j.L&&this.D<=0&&(this.I(),this.D=this.P),this.o=this.h=!1),this.N=H,this.moveTo(H)):(this.N==H&&t>this.R*(te($(this),$(H))?5:2.5)&&(this.N=null),(!this.N||Ut(this.N,this)<5)&&(this.N=this.A()),this.N.x==this.x&&this.N.y==this.y&&this.N.x++,this.moveTo(this.N)),ge(this.m,.99),be(this,this.m),tt(this,!1),[this.O.V,this.O.M,this.O.F,this.O.j].filter((t=>t!=this.O.j)).forEach((t=>{t.B<=0&&!t.L&&(t.L=!0,ht(this,t))})),this.O.V.L&&(this.L=!0,H.level+=.2)}A(){if(this.T.t){let t=lt(this.T.t[Math.floor(Math.random()*this.T.t.length)],p);return xe(t,de(0,h),de(0,40)),t}return me(this.T.G.x+de(-1,1)*this.T.size,this.T.G.y+de(-1,1)*this.T.size)}J(){let t=st(this.x,this.y);if(Ut(m,t)<d*this.size*10&&null==f){f=this,i.fillStyle="green",i.strokeStyle="rgba(200,50,50,0.5)",i.textBaseline="top",Se(i,14);let e=this.size*d*6,h=t.x-60,a=t.y-40-e;i.fillText(this.race+" Ship",h,a-20),Se(i,14),Object.entries(ct()).forEach(((e,n)=>{console.log(e);let o=a+13*n;i.fillText(e[1],h,o),i.fillRect(t.x,o+5,60*this.O[e[0]].B/this.O[e[0]].K,5)})),i.fillStyle="rgba(200,50,50,0.3)",i.strokeRect(t.x-e/2,t.y-e/2,e,e)}if(function(t,e){return t.x>-e&&t.x<s+e&&t.y>-e&&t.y<r+e}(t,d))_(this,this.U,this.h,this.o,!0);else{let e=ee(t.x,0,s),h=ee(t.y,0,r);i.strokeStyle="rgba(200,50,50,0.7)",i.lineWidth=2,i.beginPath(),Dt(i,e,h,15,Zt(t.x,t.y,e,h)),i.closePath(),i.stroke()}}moveTo(t){let e=qt(t,this);if($t(e,this.i)<2*this.g)this.i=e;else{let t=.05*-this.g*_t(e,this.i+Math.PI,this.g);t>0?this.h=!0:t<0&&(this.o=!0),this.Y+=t*(this.O.F.L?.1:1)}this.i+=this.Y,this.Y*=.9+(this.O.F.L?.09:0);let h=Ut(this,t),a=.25*Math.min(1,h/this.R)*this.speed*(this.O.M.L?.1:1);xe(this.m,this.i,a),this.U=!0}}function J(){s=window.innerWidth,r=window.innerHeight,a.width=s,a.height=r,n.width=s,n.height=r,o.width=s,o.height=r,St(s,r)}function K(){if(!t){let h=window.performance.now();for(W+=h-D,D=h;W>16;)W-=16;p+=1,function(){!function(){I=$(H),L=Object.values(H.O).forEach((e=>{if(!e.L&&e.B<=0&&(e.L=!0,e==H.O.V))return Object.values(H.O).filter((t=>t!=H.O.j)).forEach((t=>ht(H,t))),H.L=!0,void window.setTimeout((()=>{t=!0,function(){let e=se(),h=ue("Continue anyway",(()=>{!function(){Object.values(H.O).forEach((t=>{t.B=t.K,t.L=!1})),H.L=!1;let e=$(H);if(nt(e)){let t=ot(e.x,e.y);pe(H,t.G.x-t.size,t.G.y-t.size)}else pe(H,e.x*w,e.y*w);ge(H.m,0),t=!1}(),document.body.removeChild(e)})),a=ue("Start another game",(()=>{}));we(e,[re("Oh no. You died."),h,a]),window.setTimeout((()=>e.style.height="100%"),50)}()}),2500)}));let h=H.O;nt(I)?(function(t){t.t.forEach((t=>{let e=lt(t,p),h=lt(t,p+1),a=Ut(H,e);if(a<10*t.rad){let n=qt(H,e);H.m.x+=(.1*Math.cos(n)*t.rad+.5*(h.x-e.x))/Math.max(t.rad,a)**2,H.m.y+=(.1*Math.sin(n)*t.rad+.5*(h.y-e.y))/Math.max(t.rad,a)**2}}));let e=qt(H,t.G),h=Ut(t.G,H);H.m.x+=.1*Math.cos(e)*t.X/Math.max(t.X,h)**2,H.m.y+=.1*Math.sin(e)*t.X/Math.max(t.X,h)**2}(L=ot(I.x,I.y)),H.q=!1,H.Z=!1,L.t.forEach((t=>{Ut(H,lt(t,p))<t.rad&&Object.values(h).forEach((t=>{H.q=!0,t.B=Math.min(t.K,t.B+t.K/100),t.B==t.K?t.L=!1:H.Z=!0}))}))):L=null;let a=H.speed*(h.M.L?.25:1),n=H.g*(h.F.L?.5:1);(b.$||b._)&&xe(H.M,H.i,a);(b.tt||b.et)&&xe(H.M,H.i,-a);let o=-_t(Zt(s/2,r/2,m.x,m.y),H.i,n*(h.F.L?.1:1));H.h=Math.max(0,o<0?10:H.h-1),H.o=Math.max(0,o>0?10:H.o-1),$t(Zt(s/2,r/2,m.x,m.y),H.i)<n?H.i=Zt(s/2,r/2,m.x,m.y):H.i+=o*n;(b.ht||b.at)&&xe(H.M,H.i+e,-a);(b.nt||b.ot)&&xe(H.M,H.i+e,a);if(be(H.m,H.M),ut()>299792){let t=ut()/299792;ge(H.m,1/t)}be(H,H.m),ge(H.M,0),tt(H,!0)}();for(let t=0;t<10;t++)X();H.D>0&&(H.D-=1*(H.O.j.L?.5:1));g&&H.D<=0&&(H.D=H.P,Q(H.seed,H.O.j,H,H.size,H.i,H.v,H.k,H.W));for(let t=I.x-1;t<=I.x+1;t++)for(let e=I.y-1;e<=I.y+1;e++)L&&Ut(L.G,H)<w&&it(t,e).forEach((t=>{(Ut(t,H)<1e3||Z(t,H))&&y.add(t)}));y.forEach((t=>t.update())),y.forEach((t=>{Ut(t,H)>1e3&&t.N!=H&&!Z(t,H)&&te($(t),t.T)&&y.delete(t)})),y.forEach((e=>{if(e.L){let h=V[e.T.x][e.T.y];h.splice(h.indexOf(e),1),0==h.length&&(t=!0,dt(H,e,(function(){H.level+=3,console.log("unpasue"),D=window.performance.now(),t=!1}))),y.delete(e)}}))}(),function(){if(i.clearRect(0,0,s,r),c&&!c.L){let t=st(c.x,c.y),e=Xt(s/2,r/2,t.x,t.y),h=Math.min(s,r-300)/2;e>1.5*h?d=Math.min(S,Math.max(P,Math.max(d-.02,.99*d))):e<.5*h&&(d=Math.min(S,Math.max(P,Math.min(d+.02,1.01*d))))}let t={it:Math.floor((M.x-s/2/d)/w),lt:Math.floor((M.x+s/2/d)/w),st:Math.floor((M.y-r/2/d)/w),rt:Math.floor((M.y+r/2/d)/w)};null,null,M={x:H.x,y:H.y};for(let e=t.it;e<=t.lt;e++)for(let h=t.st;h<=t.rt;h++)q(e,h);z.J(),f=null,y.forEach((t=>t.J())),T.J(),function(){let t=H.x,h=H.y;++O>10&&(O=0,N.push([t,h]),N.length>500&&N.splice(0,1));if(H.L)return;if(d<5){let e=st(t,h);if(i.lineWidth=1,ie(i,e,ye(e,H.i,30),"rgb(50,150,50,0.8)"),i.beginPath(),i.strokeStyle="rgba(255,255,255,0.3)",N.length){let t=st(N[0][0],N[0][1]);i.moveTo(t.x,t.y),N.forEach((e=>{t=st(e[0],e[1]),i.lineTo(t.x,t.y)})),i.lineTo(e.x,e.y),i.stroke(),i.closePath()}}let a=b.$||b._;a&&H.O.M.points.filter((t=>Math.random()<.6)).forEach((t=>{let h=t[0]+H.O.M.Mt*Math.random(),a=xe(ye(H,H.i-e,-h),H.i,-t[1]-H.O.M.ut);!function(t,e,h){T.add([de(5,50),t,e,h+de(-.1,.1),de(40,60)])}(a.x,a.y,H.i)}));_(H,a,H.h,H.o,!1),d>5e3&&(Se(i,r/2*d/5e3*H.size),i.textBaseline="top",i.fillStyle="black",i.fillText("ðŸ‘¨â€ðŸš€",s/2-i.measureText("ðŸ‘¨â€ðŸš€").width/2,r/2),i.font="12px Arial")}(),i.strokeStyle="rgba(255,255,255,0.1)",i.strokeStyle="rgba(0,0,0,1 w)",i.lineWidth=.5,Object.entries(x).forEach((t=>{t[0];let e=t[1];i.fillStyle=e.length?Kt(e[0][6]):"black",i.beginPath(),e.forEach((t=>{let e=st(t[0],t[1]);i.moveTo(e.x-2,e.y-2),i.arc(e.x-2,e.y-2,.1*d*(t[5]<50?t[5]/50:1),0,8)})),i.fill(),i.closePath(),i.stroke()})),A.J(),Y.J();let h=$(H);Mt(ot(h.x,h.y),V[h.x]?V[h.x][h.y]:[],p)}()}window.requestAnimationFrame(K)}function Q(t,h,a,n,o,i,l,s,r){for(let M=0;M<h.C;M++){let u=h.x+ +M*(h.w+h.margin),c=Xt(0,0,n*u,n*h.top),f=Zt(0,0,n*u,n*h.top),d=r||o,w=Xt(0,0,Math.cos(o)*i+a.m.x/10,Math.sin(o)*i+a.m.y/10);U(t,a.x+Math.cos(o+e+f)*c,a.y+Math.sin(o+e+f)*c,d,w,l,s,h.ct),c=Xt(0,0,n*-u,n*h.top),f=Zt(0,0,n*-u,n*h.top),U(t,a.x+Math.cos(o+e+f)*c,a.y+Math.sin(o+e+f)*c,d,w,l,s,h.ct)}}function U(t,e,h,a,n,o,i,l){x.hasOwnProperty(t)||(x[t]=[]),x[t].push([e,h,a,n,o,i,l])}function X(){Object.values(x).forEach((t=>{for(let e=t.length-1;e>=0;e--){let h=t[e];h[0]+=Math.cos(h[2])*h[3],h[1]+=Math.sin(h[2])*h[3],(--h[5]<=0||h[0]<M.x-3*s/d||h[1]<M.y-3*r/d||h[0]>M.x+3*s/d||h[1]>M.y+3*r/d)&&t.splice(e,1)}}))}function q(t,e){if(i.lineWidth=.1,nt({x:t,y:e})){isNaN(t)&&console.log(t);let a=ot(t,e),o=Wt(a.seed),l=st(a.G.x,a.G.y),u=Ut(l,m)<a.size*d;if(u&&a,d<.5){M.x,m.x,M.y,m.y;if(u){i.strokeStyle="green",i.fillStyle="green",i.lineWidth=.5;let t=a.name;Se(i,16);let e=i.measureText(t).width;i.beginPath(),i.rect(l.x-a.size*d,l.y-a.size*d,a.size*d*2,a.size*d*2),i.moveTo(l.x-15-a.size*d-20,l.y),i.lineTo(l.x-a.size*d,l.y),i.closePath(),i.stroke(),i.fillText(t,l.x-40-e-a.size*d,l.y+6)}}let c=a.X*d;i.fillStyle=a.ft(d,1);let f=l.x,w=l.y;if(i.beginPath(),ut()>25e4){let t=Math.max(0,299792-ut())/5e4;f=s/2-t*(s/4)*Math.cos(Math.abs(l.x)),w=r/2-t*(r/4)*Math.cos(Math.abs(l.y));let e=n.getContext("2d");e.fillStyle="rgba(125,"+(155+100*Math.random())+","+(155+100*Math.random())+",0.4)",kt(e,Math.random()*s,Math.random()*r,2*Math.random()),e.fill()}i.arc(f,w,c-10*d,0,8),i.closePath(),i.fill(),i.fillStyle="yellow";for(let t=0;t<Math.min(60,Math.max(5,30*Math.log(d)));t++)i.fillStyle="rgba(255,"+Math.min(255,Math.floor(155*o()+100)+1/d)+","+Math.min(255,Math.floor(155*o()+50)+1/d)+","+.09/Math.max(.1,Math.min(5,d))+")",i.beginPath(),i.ellipse(f,w,c*(.8+.4*o()*Math.abs(o()*t*.01%1-.5)),c*(.8+.4*o()*Math.abs((o()*t*.01+.5)%2-1)),o()*h+Math.abs((o()*t*.01+.5)%2-1),0,h,0),i.fill(),i.closePath();!function(t){i.strokeStyle="white",i.lineWidth=.1,t.t.filter((t=>t.rad*d>1)).forEach((e=>{let h=st(t.G.x,t.G.y);ne(i,h.x,h.y,e.dt*d,"white"),function(t){let e=lt(t,p),h=st(e.x,e.y);Ut(h,m)<t.rad*d&&(console.log("hovered"),t);let a=t.wt+p*t.bt;i.save(),ae(i,h.x,h.y,t.rad*d,t.ft),i.clip(),i.beginPath();let n="rgba(255,255,255,0.5)",o=ye(h,a,-t.rad*d*1.7);d>.05&&(n=i.createRadialGradient(o.x,o.y,0,o.x,o.y,t.rad*d*3),n.addColorStop(0,Kt([255,255,255],.5)),n.addColorStop(1,Kt([0,0,0],0)));ae(i,o.x,o.y,t.rad*d*2,n);let l=(h,n)=>{let o=st(h.x,h.y),l=Ut(h,e);if(l<3*t.rad){let e=ye(o,a,Math.sqrt(150*l+150));i.fillStyle=t.ft,Nt(i,e.x,e.y,.95*d,h.O,h.i,{fill:t.ft,gt:n})}};l(H,!1),y.forEach((t=>l(t,!0))),i.restore()}(e)}))}(a)}}function Z(t,e){return te($(t),$(e))}function $(t){return{x:Math.floor(t.x/w),y:Math.floor(t.y/w)}}function _(t,h,a,n,o){let l=Math.floor(t.x/w),s=Math.floor(t.y/w),r=ot(l,s),M=nt({x:l,y:s}),u=M?r.size-Ut(t,r.G):0;t.size=1;let c=M?u/r.size*.25:0,f=st(t.x,t.y);Nt(i,f.x,f.y,1*d,t.O,t.i,{xt:M?qt(r.G,t):-1-t.i-e,yt:c,gt:o,U:h,h:a,o:n})}function tt(t,h){Object.entries(x).filter((e=>e[0]!=t.seed)).forEach((a=>{let n=a[0],o=a[1];for(let a=o.length-1;a>=0;a--){let u=o[a],c=(l=u[0],s=u[1],r=t.x,M=t.y,{xt:Zt(l,s,r,M),yt:Xt(l,s,r,M)}),f=Math.cos(c.xt-t.i+e)*c.yt,d=Math.sin(c.xt-t.i+e)*c.yt;Object.keys(ft).forEach((e=>{let l=t.O[e];if((!l.L||h)&&i.isPointInPath(l.path,f,d))return o.splice(a,1),l.St.moveTo(f,d),l.St.arc(f,d,.15*Math.random(),0,8),l.B=Math.max(0,l.B-u[4]),l.Pt=15,et(f,d,t),s=u,r=rt(n),void Y.add([de(5,20),s[0]+de(-1,1),s[1]+de(-1,1),r]);var s,r}))}var l,s,r,M}))}function et(t,e,h){A.add([20*Math.random(),t,e,h])}function ht(t,h){let a=st(t.x,t.y);z.add([250,a.x,a.y,t.size,t.i+e,de(0,8),de(0,1),h])}function at(t){return Kt([Math.min(255,Math.floor(75*t())),Math.min(255,Math.floor(75*t())),Math.min(255,Math.floor(75*t()))],1)}function nt(t){return C.hasOwnProperty(t.x)||(C[t.x]={}),C[t.x].hasOwnProperty(t.y)||(C[t.x][t.y]=Wt(""+Math.abs(10*t.x+345)*Math.abs(3*t.y+213)%1234)()>.9),C[t.x][t.y]}function ot(t,e){if(!nt({x:t,y:e}))return{};if(j.hasOwnProperty(t)||(j[t]={}),!j[t].hasOwnProperty(e)){let a=t>e?-2*t-1:2*t,n=t>e?-2*e-1:2*e,o=(a+n)*(a+n+1)*.5+n,l=Wt(o);R.hasOwnProperty(o)?console.log([t,e],o):R[o]=[t,e];let s=60+60*l(),r=(.1*Math.sign(l()-l())+.2*(l()-l()))*w,M=(.1*Math.sign(l()-l())+.2*(l()-l()))*w,u={x:t*w+1750+r,y:e*w+1750+M},c=.95*(1750-Math.max(Math.abs(r),Math.abs(M)))-20,f=2+Math.floor(9*l()),d=[],m=2*s;for(let a=0;a<f&&m<c;a++){let n=15+15*l(),o=Math.max(2*n+n*l(),(c-m-2*n)/(f-a)*l()),i={rad:n,dt:m+o,bt:.0012*l()+5e-4,kt:.002*l()+.001,wt:l()*h,Dt:u,ft:at(l),Wt:[t,e],index:a};m+=o+n,d.push(i)}let p=l(),b=l(),g=(t,e)=>function(t,e,h,a){let n=Math.min(255,5*-t+10+Math.floor(200*h)),o=Math.min(255,5*-t+10+Math.floor(200*a));i.fillStyle=Kt([Math.max(n,Math.min(50*t,255)),n,o],e)}(s*t,1,p,b),x=xt(l);j[t][e]={G:u,t:d,X:s,size:m,ft:g,name:x,seed:o,x:t,y:e}}return j[t][e]}function it(t,e){if(v[t]&&v[t][e]||!nt({x:t,y:e}))return[];if(V.hasOwnProperty(t)||(V[t]={}),!V[t].hasOwnProperty(e)){console.log("Actived Enemies in "+t+","+e),V[t][e]=[];let h=ot(t,e),a=h.seed,n=Wt(a),o=Math.ceil(3+12*n()*H.level/500),i=function(t,e){let h=Math.min(500,H.level)/500;const a=30+h*t()*220,n=.01+.19*h*t(),o=a/n;let i=.1-.097*ee(Math.log10(1+Math.max(0,500-H.level))/Math.log10(501)*t(),0,1);return console.log("Enemy speed:"+i),{seed:e,H:a,g:.05+.04*h*t(),S:.95,speed:i,R:Math.max(75,a*(1+t())),k:Math.ceil(1+1e3*h*t()),P:Math.min(60,60-Math.ceil(Math.log(1+H.level)/Math.log(501)*59*t())),v:n,size:1+1*t(),W:o,D:0}}(n,a);console.log("enemyStats: "+i),console.log(i),i.T=h;for(let h=0;h<o;h++){let h=new G(i);V[t][e].push(h)}}return V[t][e]}function lt(t,e){let h=t.wt+e*t.bt;return{x:t.Dt.x+Math.cos(h)*t.dt,y:t.Dt.y+Math.sin(h)*t.dt}}function st(t,e){return{x:s/2-M.x*d+t*d,y:r/2-M.y*d+e*d}}function rt(t){if(!E.hasOwnProperty(t)){let e=Wt(t);E[t]=[Math.floor(155+100*e()),Math.floor(155+100*e()),Math.floor(155+100*e())]}return E[t]}window.onload=()=>{a=document.getElementById("c"),n=document.getElementById("b"),o=document.getElementById("h"),i=a.getContext("2d"),l=o.getContext("2d");let r=null;window.addEventListener("resize",(()=>{clearTimeout(r),r=window.setTimeout(J)})),J(),window.addEventListener("keydown",(t=>b[t.code]=!0)),window.addEventListener("keyup",(t=>b[t.code]=!1)),window.addEventListener("mousedown",(t=>{g=!0,m={x:t.clientX,y:t.clientY},f&&(c=f)})),window.addEventListener("mouseup",(t=>{g=!1,k=!1}));let u=document.getElementById("zoomHandle"),w=document.getElementById("zoomBar"),p=()=>{u.style.top=w.clientHeight-ee(d/(Math.log10(S)-Math.log10(P))*w.clientHeight,0,w.clientHeight)+"px"};p(),u.addEventListener("mousedown",(t=>{t.preventDefault(),k=t.clientY-u.getBoundingClientRect().top}));let x=t=>{let e=w.getBoundingClientRect(),h=Math.max(.1,Math.min(w.clientHeight,t.clientY-e.top-k));return u.style.top=Math.min(w.clientHeight,Math.max(0,h))+"px",ee(Math.max(.1,w.clientHeight-h)/w.clientHeight*(Math.log10(S)-Math.log10(P)),P,S)};w.addEventListener("mousedown",(t=>{k=0,d=x(t),k=!0})),window.addEventListener("mousemove",(t=>{k&&(d=x(t)),g&&(M.x+=(m.x-t.clientX)/d,M.y+=(m.y-t.clientY)/d),m.x=t.clientX,m.y=t.clientY}));let y=!1;window.addEventListener("wheel",(t=>{if(y)return;y=!0,c=null;let e=t.wheelDelta?t.wheelDelta:-1*t.deltaY,h=(e+1)/(Math.abs(e)+1)*Math.min(Math.abs(e));var a=h/Math.abs(h);d=Math.min(S,Math.max(P,d*(a<0?.97:1.03))),y=!1,p()})),T=new yt((()=>{i.fillStyle="rgba(255,255,255,0.3)"}),(t=>{t[1]-=Math.cos(t[3])/50*(60-t[4])/60,t[2]-=Math.sin(t[3])/50*(60-t[4])/60,t[4]*=.999;let e=st(t[1],t[2]),a=.3*t[4]/75*(.2+.8*Math.random())*d;i.beginPath(),Math.min(30,d);for(let t=0;t<5*Math.random();t++){let t=e.x+de(-a,a),n=e.y+de(-a,a);i.moveTo(t,n),i.arc(t,n,a,0,h)}i.fill(),i.closePath()}),(()=>{}),250),A=new yt((()=>{}),(t=>{let h=function(t,e){return{angle:Zt(0,0,t,e),yt:Xt(0,0,t,e)}}(t[1],t[2]),a=Math.cos(h.xt+e+t[3].i)*h.yt,n=Math.sin(h.xt+e+t[3].i)*h.yt;Pt(i,st(t[3].x+a,t[3].y+n),.02*Math.min(15,d))}),(()=>{}),250),Y=new yt((()=>{}),(t=>{i.fillStyle=Kt(t[3],Math.random());let e=st(t[1],t[2]),h=t[0]/10;i.fillRect(e.x-h/2*d,e.y-h/2*d,h*d,h*d)}),(()=>{}),250),z=new yt((()=>{}),(t=>{console.log(123),he(i,t[1],t[2],(()=>{fe(i,d*t[3],t[4]),i.fillStyle=Kt(t[7].color),i.fill(t[7].path)})),t[1]+=Math.cos(t[5])*t[6],t[2]+=Math.sin(t[5])*t[6],t[4]+=.04,t[3]*=.99}),(()=>{}),250),function(){let h=se();we(h,[le(""),re("Space"),ue("Start game",(()=>{B(),document.body.removeChild(h),function(){B();let h=se(),a=ce(300,300),n=!1,o=a.getContext("2d"),i=()=>{o.save(),o.clearRect(0,0,300,300),o.translate(150,150),o.scale(40,40),Nt(o,0,0,1,H.O,-e,{xt:Zt(m.x,m.y,s/2,a.getBoundingClientRect().top+150),yt:.2,U:!0,h:!0,o:!0}),o.restore(),n||window.requestAnimationFrame(i)};i();let l=Me(H.race);we(h,[le(""),re("Choose a race"),a,l,le(""),ue("New Race",(()=>{B(),l.innerHTML=H.race})),ue("Confirm",(()=>{n=!0,document.body.removeChild(h),t=!1})),le(""),le("")]),h.style.height="100%"}()})),Me("Mouse to aim. </br> WASD or Arrow keys to thrust. </br> Click to shoot. "),le("")]),h.style.height="100%"}(),K()};const Mt=(t,e)=>{l.font="24px Arial",l.clearRect(0,0,s,r),function(t,e){l.fillStyle="green";let h=ut();l.font="bold 17px Arial";let a="Current Speed: "+h+"km/s",n=l.measureText(a).width;l.fillText(a,s/2-n/2,280);let o=Math.min(45,50*Xt(0,0,H.m.x,H.m.y)),i=Zt(0,0,H.m.x,H.m.y);l.fillStyle="black",l.lineWidth=2,l.save(),l.beginPath(),l.arc(s/2,175,90,0,9),l.stroke(),l.clip(),l.closePath(),l.lineWidth=2,l.beginPath(),l.moveTo(s/2,175),l.lineTo(s/2+Math.cos(i)*o,175+Math.sin(i)*o),Dt(l,s/2+Math.cos(i)*(o+7.5),175+Math.sin(i)*(o+7.5),10,i),l.closePath(),l.stroke(),l.restore()}(),t.t?function(t,e){F++;let h=s-330+150,a=175;l.save(),l.fillStyle="black",l.beginPath(),l.rect(h-150,a-150,300,300),l.clip(),l.fill(),l.closePath(),l.fillStyle="green",l.strokeRect(h-150,a-150,300,300),l.lineWidth=.4,l.beginPath();for(let t=0;t<6;t++)l.moveTo(h-150,a-150+300*t/6),l.lineTo(h+150,a-150+300*t/6),l.moveTo(h-150+300*t/6,a-150),l.lineTo(h-150+300*t/6,a+150);l.stroke(),l.closePath(),l.beginPath();let n=1.2*t.size/150,o=e=>h+(e-t.G.x)/n,i=e=>a+(e-t.G.y)/n;l.arc(h,a,t.X/n,0,8),t.t.forEach((t=>{let e=lt(t,p);l.moveTo(o(e.x),i(e.y)),l.arc(o(e.x),i(e.y),Math.max(3,t.rad/n),0,8)})),l.closePath(),l.fill(),l.fillStyle="red",l.beginPath(),e.forEach((t=>{l.moveTo(o(t.x),i(t.y)),l.arc(o(t.x),i(t.y),2+3*Math.abs(Math.abs(F-100)%200-100)/100,0,8)})),l.closePath(),l.fill(),l.fillStyle="yellow";let r=o(H.x),M=i(H.y);if(l.beginPath(),l.arc(Math.max(h-150,Math.min(h+150,r)),Math.max(a-150,Math.min(a+150,M)),2+3*Math.abs(F%200-100)/100,0,8),l.closePath(),l.fill(),l.strokeStyle="yellow",l.globalAlpha=.5,l.lineWidth=.5,l.beginPath(),N.length){let t=o(N[0][0]),e=i(N[0][1]);l.moveTo(t,e),N.forEach((h=>{t=o(h[0]),e=i(h[1]),l.lineTo(t,e)})),l.lineTo(r,M),l.stroke(),l.closePath()}l.globalAlpha=1;let u=t.name||" ",c=l.measureText(u).width;l.fillStyle="green",l.fillText(u,s-175-c/2,30),u="Hostile Ships: "+e.length,c=l.measureText(u).width,e&&l.fillText(u,s-175-c/2,300);l.restore()}(t,e):function(){F++;let t=s-330+150,e=175;l.fillStyle="black",l.fillRect(t-150,e-150,300,300),l.fillStyle="green",l.strokeRect(t-150,e-150,300,300),l.save(),l.rect(t-150,e-150,300,300),l.clip(),l.lineWidth=.2,l.beginPath();for(let h=0;h<8;h++)l.moveTo(t-150,Math.floor(e-150+300*h/8)),l.lineTo(t+150,Math.floor(e-150+300*h/8)),l.moveTo(Math.floor(t-150+300*h/8),e-150),l.lineTo(Math.floor(t-150+300*h/8),e+150);l.stroke(),l.closePath();let h=4,a=$(H),n=e=>t+(e-H.x)/(w*h*2/300),o=t=>e+(t-H.y)/(w*h*2/300);l.beginPath();for(let t=a.x-h;t<a.x+h;t++)for(let e=a.y-h;e<a.y+h;e++)if(nt({x:t,y:e})){let a=ot(t,e);l.moveTo(n(a.G.x),o(a.G.y)),l.arc(n(a.G.x),o(a.G.y),a.X/(w*h/300),0,8);let i=a.name;l.measureText(i).width}l.closePath(),l.fill(),l.font="12px Arial";for(let t=a.x-h;t<a.x+h;t++)for(let e=a.y-h;e<a.y+h;e++)if(nt({x:t,y:e})){let h=ot(t,e),a=h.name,i=l.measureText(a).width;l.fillText(a,n(h.G.x)-i/2,o(h.G.y)+5)}l.fillStyle="yellow",l.beginPath(),l.arc(t,e,2+3*Math.abs(F%200-100)/100,0,8),l.closePath(),l.fill(),l.restore()}(),l.strokeStyle="green",l.fillStyle="black",l.strokeRect(25,25,400,300),l.fillRect(25,25,400,300),he(l,150,175,(()=>{l.lineWidth=.03,l.fillStyle="black",l.strokeStyle="green",Nt(l,0,0,40,H.O,H.i,{fill:"black",stroke:"green"})})),function(){let t={vt:"hull",Ht:"wings",Ot:"thrust",Ct:"weapons"},e=50,h=275;l.strokeStyle="green",l.lineWidth=1,l.textBaseline="top",l.font="bold 18px Arial",l.fontWeight=800;let a=0,n=0;Object.entries(t).forEach((t=>{var o;a+=H.O[t[1]].B,n+=H.O[t[1]].K,l.fillStyle="green",l.fillText(t[0],h,e),l.strokeRect(h,e+20,100,10),l.fillStyle=(o=H.O[t[1]]).L?"grey":o.Pt?(o.Pt--,"red"):"rgba("+(207-207*o.B/o.K)+","+(41+204*o.B/o.K)+","+(56+61*o.B/o.K)+",1)",l.fillRect(h,e+20,100*H.O[t[1]].B/H.O[t[1]].K,10),e+=55})),l.strokeRect(50,35,200,12),l.fillRect(50,35,200*H.O.V.B/H.O.V.K,12),e-=55,l.fillStyle="rgba(200,200,50,"+(.5-.5*H.D/H.P+.5)+")",l.strokeRect(h,e+30,100,4),l.fillRect(h,e+30,100-100*H.D/H.P,4)}()};function ut(){return Math.floor(1e3*Xt(0,0,H.m.x,H.m.y))/10}const ct=()=>{let t={};return Object.keys(ft).forEach((e=>t[e]=ft[e].name)),console.log(t),t};const ft={j:{name:"Weapons",jt:{Rt:t=>t.O.j.K,Tt:t=>t.P,At:t=>t.k,Yt:t=>t.v,Range:t=>t.W*t.v},zt:{Tt:t=>mt(60/t,3),Yt:t=>mt(100*t,1)},suffixes:{Tt:"/s",Yt:"km/s"},J:(t,e)=>{he(t,0,1,(()=>Gt(t,e,.5,.5)))},It:(t,e,h,a)=>jt(e.j,h.j,a)},V:{name:"Hull",jt:{Rt:t=>t.O.V.K},J:(t,e)=>Ft(e,t,.5,.5),It:(t,e,h,a)=>function(t,e,h){let a=Ct(t,e,["topW","bottomW","h","controlTop","controlSide","windowSize","maxHp"],h);return a.path=At(a),a}(e.V,h.V,a)},F:{name:"Wings",zt:{Lt:t=>mt(100*t,3)},jt:{Rt:t=>t.O.F.K,Lt:t=>t.g},J:(t,e)=>Bt(e,t,.5,.5),It:(t,e,h,a)=>function(t,e,h,a){let n=[];for(let o=0;o<h.list.length;o++)if(e.list[o]&&h.list[o]){let i=e.list[o],l=h.list[o],s=Ct(i,l,["topW","bottomW","h0","h1","h2","h3"],a);s.offsetTop=Ot(i.offsetTop,l.offsetTop,a),s.path=Lt(s.Nt,s.Vt,s.Et,s.Ft,s.ut,s.Bt,-t/2,i.Gt^l.Gt),n.push(s)}else n.push(h.list[o]);let o=new Path2D;n.forEach((t=>o.addPath(t.path)));let i=Ct(e,h,["maxW","maxY","minY","maxH","maxHp"],a);return i.C=h.C,i.list=n,i.path=o,i}(t.V.Jt,e.F,h.F,a)},M:{name:"Thrust",zt:{Kt:t=>mt(1e3*t,3)},jt:{Rt:t=>t.O.F.K,Kt:t=>t.speed},J:(t,e)=>he(t,0,-5/4,(()=>Et(e,t,.5,.5,!0))),It:(t,e,h,a)=>Rt(t.V,e.M,h.M,a)}},dt=(t,e,h)=>{let a=Math.min(150,Math.max(30,window.innerWidth/8)),n=se(),o=le("cont");n.appendChild(re("Assimilation")),n.appendChild(Me("You destroyed all of the "+e.race+"s. Now steal their tech.")),n.appendChild(o),n.appendChild(Me("Click Ship parts on the right to assimilate"));let i=le("col"),l=le("col"),s=le("colWide"),r=le("col"),M=le("col"),u=ce(a,2*a),c=u.getContext("2d"),f=ce(a,2*a),d=f.getContext("2d");i.appendChild(u),r.appendChild(f);let w=!1,m={V:t.O.V,F:t.O.F,j:t.O.j,M:t.O.M};const p=t=>{c.clearRect(0,0,a,2*a),d.clearRect(0,0,a,2*a);let h={xt:.5*-Math.PI,yt:.1,U:!0,h:!0,o:!0};Nt(c,a/2,a,a/5,t,.5*-Math.PI,h),Nt(d,a/2,a,a/5,e.O,.5*-Math.PI,h),w||window.requestAnimationFrame((()=>p(t)))};p(m);let b=ft;Object.values(b).forEach((t=>{t.Qt={},t.Ut={},t.Xt={}})),Object.keys(b).forEach((h=>{let n=le("comp"),o=ce(a,a),i=o.getContext("2d");i.translate(a/2,a/2),i.scale(a/5,a/5),b[h].J(i,m),n.appendChild(o);let r=le("compWide"),u=le("statCol"),c=le("statCol"),f=le("statCol"),d=le("statCol"),w=le("statCol");we(r,[u,c,f,d,w]),Object.entries(b[h].jt).forEach((a=>{let n=a[0],o=a[1](t),i=le("statValue"),l=le("statValueChange"),s=le("statValue2"),r=le("statName");r.innerHTML=n,b[h].Qt[n]=i,b[h].Xt[n]=l,l.innerHTML="(+0)",b[h].Ut[n]=o,i.innerHTML=wt(b[h],n,o),s.innerHTML=wt(b[h],n,a[1](e)),u.appendChild(i),c.appendChild(l),f.appendChild(r),w.appendChild(s)}));let p=le("comp clickable"),g=ce(a,a),x=g.getContext("2d");x.translate(a/2,a/2),x.scale(a/5,a/5),b[h].J(x,e.O),p.appendChild(g),g.addEventListener("click",(()=>{!function(t,e,h,a,n,o,i){let l,s,r,M,u=50,c=h[a],f=(t,n)=>{null!=t&&null!=n&&(!0,u--,i[a]=c.It(i,t,n,Math.max(.5,u/50)),"hull"!=a&&"thrust"!=a||(i.M.top=i.V.Jt/2,i.M.qt=i.V.Vt,i.M=h.M.It(i,i,i,.5)),e.clearRect(-150,-150,300,300),e.save(),e.shadowBlur="15px",e.shadowColor="red",c.J(e,i),e.restore(),u>0?window.requestAnimationFrame((()=>{f(t,n)})):!1)};t.classList.contains("selected")?(t.classList.remove("selected"),c.selected=!1,r=t=>c.jt[t](n),M=()=>0,l=i,s=n.O):(u=50,t.classList.add("selected"),c.selected=!0,r=t=>(c.jt[t](n)+c.jt[t](o))/2,M=t=>{let e=c.jt[t];e(n);let h=c.zt&&c.zt[t]?c.zt[t]:mt;return h((e(n)+e(o))/2)-h(e(n))},l=n.O,s=o.O);Object.entries(c.jt).forEach((t=>{let e=t[0];c.Qt[e].innerHTML=wt(c,e,r(e));let h=M(e);c.Xt[e].innerHTML="("+(h>=0?"+":"")+mt(h)+")",c.Xt[e].className=h>0?"plus":h<0?"minus":""})),f(l,s)}(p,i,b,h,t,e,m)})),l.appendChild(n),s.appendChild(r),M.appendChild(p)})),we(o,[i,l,s,M,r]);let g=ue("Confirm",(()=>{t.O=m,n.style.height="0%",window.setTimeout((()=>{document.body.removeChild(n),w=!0,Object.entries(b).filter((t=>t[1].selected)).forEach((h=>{switch(h[0]){case"wings":t.g=(t.g+e.g)/2;break;case"weapons":t.k=(t.k+e.k)/2,t.P=(t.P+e.P)/2,t.v=(t.v+e.v)/2,t.H=(t.H+e.H)/2,t.W=t.H/t.v;break;case"thrust":t.speed=(t.speed+e.speed)/2}})),h()}),300)}));n.appendChild(g),window.setTimeout((()=>n.style.height="100%"),50),document.body.appendChild(n)};function wt(t,e,h){let a=t.zt&&t.zt[e]?t.zt[e]:mt,n=t.suffixes&&t.suffixes[e]?t.suffixes[e]:"";return a(h,1)+n}function mt(t,e){return 0==t?t:(e=e||Math.ceil(Math.abs(Math.log10(Math.abs(Math.max(-1,Math.min(1,t))))))+1,Math.floor(Math.pow(10,e)*t)/Math.pow(10,e))}var pt="AEIOUY",bt="BCDFGHJKLMNPQRSTVWXY";const gt=t=>{let e="";for(let h=Math.round(t());h<3+3*t();h++){let a=(h+1)%2?pt[Math.floor(t()*(pt.length-.1))]:bt[Math.floor(t()*(bt.length-.1))];e+=0==e.length?a:a.toLowerCase()}return e+=["ian","ord","an","ar","'ok"][Math.floor(4.9*t())],e};const xt=t=>{let e="";for(let h=Math.round(t());h<5+3*t();h++)e+=h%2?pt[Math.floor(t()*(pt.length-.1))]:bt[Math.floor(t()*(bt.length-.1))];var h;return e+=t()>.5?" "+((h=t())<.2?"IV.":h<.4?"V.":h<.6?"III.":h<.8?"II.":""):"",e};class yt{constructor(t,e,h,a){this.Zt=t,this.$t=e,this._t=h,this.list=[],this.max=a}J(){this.Zt();for(let t=this.list.length-1;t>=0;t--)--this.list[t][0]>0?this.$t(this.list[t]):this.list.splice(t,1);this._t()}add(t){this.list.push(t),this.list.length>this.max&&this.list.splice(0,1)}}const St=(t,e)=>{let h=document.getElementById("b");h.style.margin=0,document.body.margin=0,h.width=t,h.height=e;let a=h.getContext("2d");for(let h=0;h<1e3;h++)a.fillStyle=Kt([125,155+100*Math.random(),155+100*Math.random()],.4),kt(a,Math.random()*t,Math.random()*e,2*Math.random())};p=0;const Pt=(t,e,h)=>{p++;for(let a=0;a<1;a++)t.fillStyle="rgba(255,"+Math.floor(Math.abs(p%14-7)/7*100+150)+","+Math.floor(Math.abs(p%34-17)/17*55+100)+","+(.3+.5*Math.random())+")",t.beginPath(),t.ellipse(e.x,e.y,.3+1.2*h*Math.random(),.3+.9*h*Math.random(),.01*p%1.248*Math.PI*2,0,2*Math.PI,0),t.fill(),t.closePath()};const kt=(t,e,h,a)=>{let n=Math.random()*Math.PI*2;t.lineWidth=.5*a,t.beginPath(),Dt(t,e,h,a,n),Dt(t,e,h,a,n+Math.PI),t.fill(),t.closePath()},Dt=(t,e,h,a,n)=>{let o=2*Math.PI/3;t.moveTo(e+Math.cos(n)*a,h+Math.sin(n)*a),t.lineTo(e+Math.cos(n+o)*a,h+Math.sin(n+o)*a),t.lineTo(e+Math.cos(n+2*o)*a,h+Math.sin(n+2*o)*a)};const Wt=t=>{return e=t,function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296};var e};function vt(t,e){let h=Wt(t);return Ht(h,e)}const Ht=(t,e)=>{let h=function(t){return[Math.floor(55+50*t()),Math.floor(55+50*t()),Math.floor(55+50*t())]}(t),a=function(t){let e=Math.floor(155*t());return[e,e,e]}(t),n=Math.ceil(2+t()*e),o=function(t,e,h){const a=de(.5,1.5,t),n=de(.5,2.5,t);let o={Nt:a,Vt:de(.5,2,t),Jt:n,te:t()*n,ee:a/2*t(),he:de(.2,.5,t)};return o.path=At(o),o.B=3*h,o.K=3*h,o.St=new Path2D,o.color=e,o}(t,h,n),i=function(t,e,h,a,n){let o=t.Vt,i=t.Jt,l=-t.Jt/2,s=-t.Jt/2,r=Math.ceil(4*e()),M=[];for(let n=0;n<r;n++){let n=3*e()+Math.min(t.Vt,t.Nt),r=4*e()+Math.min(t.Vt,t.Nt),u=e()*t.Jt/2,c=t.Jt*(.3*e()),f=c+(t.Jt-c)*(.2*e()+.1),d=f+(t.Jt-f)*e()*.8,w=d+(t.Jt-d)*e(),m=e()<.5;M.push({Nt:n,Vt:r,Et:c,Ft:f,ut:d,Bt:w,offsetTop:u,St:new Path2D,color:e()<.3?h:a,Gt:m,path:Lt(n,r,c,f,d,w,-t.Jt/2,m)}),s>u-t.Jt&&(s=u-t.Jt),l<u+w-t.Jt&&(l=u+w-t.Jt,o=r,i=w)}let u=new Path2D;return M.forEach((t=>u.addPath(t.path))),{ae:o,ne:l,oe:s,ie:i,C:r,list:M,path:u,color:h,St:new Path2D,B:n,K:n}}(o,t,h,a,n),l=function(t,e,h,a){let n=Math.ceil(5*t()),o=e.Vt,i=2*t()*e.Vt,l=2.5*t()*i/(n+2),s=e.Jt/2,r=Math.ceil(1e3*t()*2)/1e3,M=(.5+.5*t())*r,u=r-M,c=i/(n+1),f=[];for(let t=1;t<=n;t++)f.push([-i/2+t*c-l/2,s+M]);return{Jt:r,Ft:M,ut:u,qt:o,le:i,Mt:l,top:s,C:n,se:c,color:h,points:f,path:Yt(s,o,M,i),re:zt(f,l,u),St:new Path2D,B:a,K:a}}(t,o,h,n),s=function(t,e,h,a){let n=Math.ceil(3*t()),o=[Math.floor(155+100*t()),Math.floor(155+100*t()),Math.floor(155+100*t())],i=.1+.15*t(),l=Math.max.apply(null,e.list.map((t=>t.Vt))),s=Math.min.apply(null,e.list.map((t=>t.Vt))),r=0-l/2+t()*(l/2-n*i),M=Math.max((0-r-n*i)/(n+1),0),u=1.2*e.ie*t(),c=e.ne-e.ie,f=(.3+.5*t())*i,d=i,w=u*t(),m=u-w,p=[[-f/2,0],[-f/2,w],[-d/2,w],[-d/2,w+m],[d/2,w+m],[d/2,w],[f/2,w],[f/2,0]],b=new Path2D;b.rect(r,c,(i+M)*n*2+2*M,u);let g=t()<.5;return{Me:f,ue:d,Ft:w,ut:m,w:i,Jt:u,x:r,top:c,margin:M,C:n,ce:l,fe:s,color:h,ct:o,Gt:g,de:It(p,g),B:a,K:a,St:new Path2D,path:b}}(t,i,a,n);return{V:o,F:i,M:l,j:s}};function Ot(t,e,h){return t*h+e*(1-h)}function Ct(t,e,h,a){let n={};return h.forEach((h=>{n[h]=Ot(t[h],e[h],a)})),n.color=Tt(t.color,e.color,a),n.St=new Path2D,n.B=n.K,n}const jt=(t,e,h)=>{let a=Ct(t,e,["w","x","top","margin","h","topW1","topW2","h1","h2","maxHp"],h),n=[[-a.Me/2,0],[-a.Me/2,a.Ft],[-a.ue/2,a.Ft],[-a.ue/2,a.Ft+a.ut],[a.ue/2,a.Ft+a.ut],[a.ue/2,a.Ft],[a.Me/2,a.Ft],[a.Me/2,0]];return a.C=e.C,a.path=new Path2D,a.path.rect(a.x,a.top,(a.w+a.margin)*a.C*2+2*a.margin,a.Jt),a.Gt=t.Gt^e.Gt,a.ce=Math.min(t.ce,e.ce),a.fe=Math.max(t.fe,e.fe),a.de=It(n,a.Gt),a.ct=Tt(t.ct,e.ct,h),a},Rt=(t,e,h,a)=>{let n=Ct(e,h,["h","w1","w2","h1","h2","tw","maxHp"],a);n.C=h.C,n.top=Ot(e.top,t.Jt/2,a),n.se=n.le/(n.C+1),n.points=[];for(let t=1;t<=n.C;t++)n.points.push([-n.le/2+t*n.se-n.Mt/2,n.top+n.Ft]);return n.path=Yt(n.top,n.qt,n.Ft,n.le),n.re=zt(n.points,n.Mt,n.ut),n};function Tt(t,e,h){return[t[0]*h+(1-h)*e[0],t[1]*h+(1-h)*e[1],t[2]*h+(1-h)*e[2]]}function At(t){let e=new Path2D;e.moveTo(-t.Nt/2,-t.Jt/2);let h=t.Nt/2,a=t.Jt/2;return e.bezierCurveTo(-h+t.ee,-a-t.te,h-t.ee,-a-t.te,h,-a),e.lineTo(t.Vt/2,a),e.lineTo(-t.Vt/2,a),e.lineTo(-t.Nt/2,-a),e}function Yt(t,e,h,a){let n=new Path2D;return n.moveTo(-e/2,t),n.lineTo(e/2,t),n.lineTo(a/2,t+h),n.lineTo(-a/2,t+h),n.lineTo(-e/2,t),n}function zt(t,e,h){let a=new Path2D;return t.forEach((t=>{a.rect(t[0],t[1],e,h)})),a}function It(t,e){let h=new Path2D;if(e){h.moveTo(t[0][0],t[0][1]);let e=1;for(e=1;e<t.length-2;e++){let a=(t[e][0]+t[e+1][0])/2,n=(t[e][1]+t[e+1][1])/2;h.quadraticCurveTo(t[e][0],t[e][1],a,n)}h.quadraticCurveTo(t[e][0],t[e][1],t[e+1][0],t[e+1][1])}else{h.moveTo(t[0][0],t[0][1]);for(let e=1;e<t.length;e++)h.lineTo(t[e][0],t[e][1])}return h.lineTo(t[0][0],t[0][1]),h}function Lt(t,e,h,a,n,o,i,l){let s=new Path2D,r=[[0,i+h],[-t/2,i+a],[-e/2,i+n],[0,i+o],[e/2,i+n],[t/2,i+a],[0,i+h]];if(l){s.moveTo(r[0][0],r[0][1]);let t=1;for(t=1;t<r.length-2;t++){let e=(r[t][0]+r[t+1][0])/2,h=(r[t][1]+r[t+1][1])/2;s.quadraticCurveTo(r[t][0],r[t][1],e,h)}s.quadraticCurveTo(r[t][0],r[t][1],r[t+1][0],r[t+1][1])}else{s.moveTo(r[0][0],r[0][1]);for(let t=1;t<r.length;t++)s.lineTo(r[t][0],r[t][1])}return s}const Nt=(t,e,h,a,n,o,i)=>{he(t,e,h,(()=>{fe(t,a,o+.5*Math.PI),n.j.L&&i.gt||Gt(t,n,i),n.F.L&&i.gt||Bt(n,t,i),n.V.L&&i.gt||Ft(n,t,i),n.M.L&&i.gt||Et(n,t,i)}))};function Vt(t,e,h,a){h.forEach((h=>{a.fill&&(t.fillStyle=a.fill,t.fill(h)),a.stroke&&(t.strokeStyle=a.stroke,t.stroke(h)),a.stroke||a.fill||Jt(t,h,Kt(e.color),Qt(e.color,15),a.xt,a.yt)}))}const Et=(t,e,h)=>{Vt(e,t.M,[t.M.path,t.M.re],h);let a=t.M,n=a.le/(a.C+1);for(let t=1;t<=a.C;t++)if(h.U){let h=a.top+a.Ft+a.ut;const o=-a.le/2+t*n-a.Mt/2;e.fillStyle="rgba(255,55,55,0.8)",e.fillRect(o,h,a.Mt,de(.1,.25)),e.fillStyle="rgba(255,255,55,0.8)",e.fillRect(o,h,a.Mt,de(.1,.25))}},Ft=(t,e,h)=>{if(Vt(e,t.V,[t.V.path],h),!h.fill&&!h.stroke){e.save(),e.clip(t.V.St),e.fillStyle=h.fill||"rgba(0,0,0,0.7)",e.fill(t.V.path),e.restore();let a=t.V.Nt/2*t.V.he,n=e.createLinearGradient(-a,0,a,0);n.addColorStop(0,"rgba(50,250,250,1)"),n.addColorStop(1,"rgba(50,150,150,1)");let o=e.createLinearGradient(-a,0,a,0);o.addColorStop(0,"rgba(250,250,250,1)"),o.addColorStop(1,"rgba(255,255,255,1)"),e.save(),e.scale(t.V.he,t.V.he),Jt(e,t.V.path,n,o,h.xt,h.yt),e.restore()}},Bt=(t,e,h)=>{for(let a=0;a<t.F.C;a++){let n=t.F.list[a];Jt(e,n.path,h.fill||Kt(n.color),h.fill||Qt(n.color,15),h.we,h.me),h.stroke&&e.stroke(n.path),h.gt&&(e.save(),e.clip(t.F.St),e.fillStyle=h.fill||"rgba(0,0,0,0.7)",e.fill(n.path),e.restore())}if(h.h||h.o){let a=0,n=0,o=()=>{e.fillRect(a,n,.1,de(.2,.35))},i=()=>{e.fillStyle="rgba(255,55,55,0.8)",o(),e.fillStyle="rgba(255,255,55,0.8)",o()};h.h&&(a=t.F.ae/2*.8-.1,n=t.F.ne,i()),h.o&&(a=-t.F.ae/2*.8,n=t.F.ne,i())}},Gt=(t,e,h)=>{t.fillStyle=Kt(e.j.color);for(let a=0;a<e.j.C;a++){let n=()=>Jt(t,e.j.de,h.fill||Kt(e.j.color),h.fill||Qt(e.j.color,15),h.xt,.4*h.yt);const o=e.j.w+e.j.margin;he(t,-e.j.x-a*o,e.j.top,n),he(t,e.j.x+a*o,e.j.top,n)}};function Jt(t,e,h,a,n,o){t.save(),t.fillStyle=a,t.fill(e),t.clip(e),t.translate(Math.cos(n)*o,Math.sin(n)*o),t.fillStyle=h,t.fill(e),t.strokeStyle="rgba(255,255,255,0.4)",t.restore()}function Kt(t,e=1){return function(t,e,h,a){return"rgba("+t+","+e+","+h+","+a+")"}(t[0],t[1],t[2],e)}function Qt(t,e){return Kt(t.map((t=>Math.min(255,t+e))))}function Ut(t,e){try{return Xt(t.x,t.y,e.x,e.y)}catch(h){console.log(t,e),console.log(h)}}function Xt(t,e,h,a){return Math.sqrt(Math.pow(h-t,2)+Math.pow(a-e,2))}function qt(t,e){return Zt(t.x,t.y,e.x,e.y)}function Zt(t,e,h,a){return Math.atan2(a-e,h-t)}function $t(t,e){return Math.abs((t+2*Math.PI)%(2*Math.PI)-(e+2*Math.PI)%(2*Math.PI))}function _t(t,e,h){return t%=2*Math.PI,e%=2*Math.PI,t<0&&(t+=2*Math.PI),e<0&&(e+=2*Math.PI),Math.abs(e-t)>h?function(t,e){let h=t-e;h<0&&(h+=2*Math.PI);return h>Math.PI?1:-1}(t,e)>0?1:-1:0}function te(t,e){return t.x==e.x&&t.y==e.y}function ee(t,e,h){return Math.min(h,Math.max(e,t))}function he(t,e,h,a){t.save(),t.translate(e,h),a(),t.restore()}const ae=(t,e,h,a,n)=>{oe(t,e,h,a),t.fillStyle=n,t.fill()},ne=(t,e,h,a,n)=>{oe(t,e,h,a),t.strokeStyle=n,t.stroke()},oe=(t,e,h,a)=>{t.beginPath(),t.arc(e,h,a,0,8),t.closePath()},ie=(t,e,h,a)=>{a&&(t.strokeStyle="white"),t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(h.x,h.y),t.stroke(),t.closePath()},le=t=>{let e=document.createElement("div");return e.className=t,e},se=()=>{let t=le("dialog");return document.body.appendChild(t),t},re=t=>{let e=le("title");return e.innerHTML=t,e},Me=t=>{let e=le("subTitle");return e.innerHTML=t,e},ue=(t,e)=>{let h=document.createElement("button");return h.onclick=e,h.innerHTML=t,h},ce=(t,e)=>{let h=document.createElement("canvas");return h.width=t,h.height=e,h},fe=(t,e,h)=>{t.scale(e,e),t.rotate(h)},de=(t=0,e=1,h=Math.random)=>t+(e-t)*h(),we=(t,e)=>{e.forEach((e=>t.appendChild(e)))},me=(t,e)=>({x:t,y:e}),pe=(t,e,h)=>{t.x=e,t.y=h},be=(t,e)=>{t.x+=e.x,t.y+=e.y},ge=(t,e)=>{t.x*=e,t.y*=e},xe=(t,e,h)=>(t.x+=Math.cos(e)*h,t.y+=Math.sin(e)*h,t),ye=(t,e,h)=>({x:t.x+Math.cos(e)*h,y:t.y+Math.sin(e)*h}),Se=(t,e)=>{t.font=e+"px Gill Sans MT"}}();</script>
     
</body>

</html>